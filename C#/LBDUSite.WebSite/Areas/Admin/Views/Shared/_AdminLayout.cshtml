@{
    var currentController = ViewContext.RouteData.Values["controller"]?.ToString();
    var currentAction = ViewContext.RouteData.Values["action"]?.ToString();

    bool IsActive(string controller, string action = "Index")
    {
        return currentController?.Equals(controller, StringComparison.OrdinalIgnoreCase) == true &&
               (action == null || currentAction?.Equals(action, StringComparison.OrdinalIgnoreCase) == true);
    }
}

<aside class="admin-sidebar" id="adminSidebar">
    <!-- Brand -->
    <div class="sidebar-brand">
        <h4><i class="fas fa-shield-alt"></i> LBDU Admin</h4>
        <p>ระบบจัดการกองทุน</p>
    </div>

    <!-- Menu -->
    <nav>
        <ul class="sidebar-menu">
            <!-- Dashboard -->
            <li>
                <a href="@Url.Action("Index", "Dashboard", new { area = "Admin" })"
                   class="@(IsActive("Dashboard") ? "active" : "")">
                    <i class="fas fa-tachometer-alt"></i>
                    <span>Dashboard</span>
                </a>
            </li>

            <!-- Divider -->
            <li style="margin: 10px 20px; border-top: 1px solid rgba(255,255,255,0.1);"></li>

            <!-- Fund Management -->
            <li>
                <a href="@Url.Action("Index", "Fund", new { area = "Admin" })"
                   class="@(IsActive("Fund") ? "active" : "")">
                    <i class="fas fa-chart-pie"></i>
                    <span>จัดการกองทุน</span>
                </a>
            </li>

            <!-- AMC Management -->
            <li>
                <a href="@Url.Action("Index", "AMC", new { area = "Admin" })"
                   class="@(IsActive("AMC") ? "active" : "")">
                    <i class="fas fa-building"></i>
                    <span>บริษัทจัดการ</span>
                </a>
            </li>

            <!-- Fund Class -->
            <li>
                <a href="@Url.Action("Index", "FundClass", new { area = "Admin" })"
                   class="@(IsActive("FundClass") ? "active" : "")">
                    <i class="fas fa-layer-group"></i>
                    <span>คลาสกองทุน</span>
                </a>
            </li>

            <!-- NAV Data -->
            <li>
                <a href="@Url.Action("Index", "FundNAV", new { area = "Admin" })"
                   class="@(IsActive("FundNAV") ? "active" : "")">
                    <i class="fas fa-chart-line"></i>
                    <span>ข้อมูล NAV</span>
                </a>
            </li>

            <!-- Divider -->
            <li style="margin: 10px 20px; border-top: 1px solid rgba(255,255,255,0.1);"></li>

            <!-- Content Management -->
            <li>
                <a href="@Url.Action("Index", "Article", new { area = "Admin" })"
                   class="@(IsActive("Article") ? "active" : "")">
                    <i class="fas fa-newspaper"></i>
                    <span>บทความ</span>
                </a>
            </li>

            <!-- Learning -->
            <li>
                <a href="@Url.Action("Index", "Learning", new { area = "Admin" })"
                   class="@(IsActive("Learning") ? "active" : "")">
                    <i class="fas fa-graduation-cap"></i>
                    <span>เนื้อหาการเรียนรู้</span>
                </a>
            </li>

            <!-- Banner -->
            <li>
                <a href="@Url.Action("Index", "Banner", new { area = "Admin" })"
                   class="@(IsActive("Banner") ? "active" : "")">
                    <i class="fas fa-images"></i>
                    <span>แบนเนอร์</span>
                </a>
            </li>

            <!-- Divider -->
            <li style="margin: 10px 20px; border-top: 1px solid rgba(255,255,255,0.1);"></li>

            <!-- User Management (Admin Only) -->
            @if (ViewBag.CurrentAdminRole == "Super Administrator" || ViewBag.CurrentAdminRole == "Administrator")
            {
                <li>
                    <a href="@Url.Action("Index", "AdminUser", new { area = "Admin" })"
                       class="@(IsActive("AdminUser") ? "active" : "")">
                        <i class="fas fa-users-cog"></i>
                        <span>ผู้ดูแลระบบ</span>
                    </a>
                </li>

                <li>
                    <a href="@Url.Action("Index", "ActivityLog", new { area = "Admin" })"
                       class="@(IsActive("ActivityLog") ? "active" : "")">
                        <i class="fas fa-history"></i>
                        <span>ประวัติการใช้งาน</span>
                    </a>
                </li>
            }

            <!-- Divider -->
            <li style="margin: 10px 20px; border-top: 1px solid rgba(255,255,255,0.1);"></li>

            <!-- Settings -->
            <li>
                <a href="@Url.Action("Index", "Settings", new { area = "Admin" })"
                   class="@(IsActive("Settings") ? "active" : "")">
                    <i class="fas fa-cog"></i>
                    <span>ตั้งค่าระบบ</span>
                </a>
            </li>

            <!-- API Sync -->
            <li>
                <a href="@Url.Action("Index", "APISync", new { area = "Admin" })"
                   class="@(IsActive("APISync") ? "active" : "")">
                    <i class="fas fa-sync"></i>
                    <span>ซิงค์ข้อมูล API</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Footer -->
    <div style="position: absolute; bottom: 0; width: 100%; padding: 20px; text-align: center; border-top: 1px solid rgba(255,255,255,0.1);">
        <small style="color: rgba(255,255,255,0.6); font-size: 11px;">
            © @DateTime.Now.Year LBDU Admin<br />
            Version 1.0.0
        </small>
    </div>
</aside>