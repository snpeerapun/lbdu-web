@model LBDUSite.Areas.Admin.Models.PagedResult<object>

@if (Model.TotalPages > 1)
{
    <div class="pagination-container">
        <div class="pagination-info">
            แสดง @((Model.CurrentPage - 1) * Model.PageSize + 1) - @(Math.Min(Model.CurrentPage * Model.PageSize, Model.TotalCount)) 
            จากทั้งหมด @Model.TotalCount รายการ
        </div>

        <nav aria-label="Page navigation">
            <ul class="pagination">
                <!-- Previous -->
                <li class="page-item @(Model.HasPrevious ? "" : "disabled")">
                    <a class="page-link" 
                       href="@(Model.HasPrevious ? Url.Action(ViewContext.RouteData.Values["action"].ToString(), new { 
                           page = Model.CurrentPage - 1, 
                           pageSize = Model.PageSize, 
                           search = Model.Search,
                           sortBy = Model.SortBy,
                           sortOrder = Model.SortOrder
                       }) : "#")"
                       aria-label="Previous">
                        <i class="fas fa-chevron-left"></i>
                    </a>
                </li>

                @{
                    var startPage = Math.Max(1, Model.CurrentPage - 2);
                    var endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);

                    if (startPage > 1)
                    {
                        <li class="page-item">
                            <a class="page-link" href="@Url.Action(ViewContext.RouteData.Values["action"].ToString(), new { 
                                page = 1, 
                                pageSize = Model.PageSize, 
                                search = Model.Search,
                                sortBy = Model.SortBy,
                                sortOrder = Model.SortOrder
                            })">1</a>
                        </li>
                        if (startPage > 2)
                        {
                            <li class="page-item disabled"><span class="page-link">...</span></li>
                        }
                    }

                    for (var i = startPage; i <= endPage; i++)
                    {
                        <li class="page-item @(i == Model.CurrentPage ? "active" : "")">
                            <a class="page-link" href="@Url.Action(ViewContext.RouteData.Values["action"].ToString(), new { 
                                page = i, 
                                pageSize = Model.PageSize, 
                                search = Model.Search,
                                sortBy = Model.SortBy,
                                sortOrder = Model.SortOrder
                            })">@i</a>
                        </li>
                    }

                    if (endPage < Model.TotalPages)
                    {
                        if (endPage < Model.TotalPages - 1)
                        {
                            <li class="page-item disabled"><span class="page-link">...</span></li>
                        }
                        <li class="page-item">
                            <a class="page-link" href="@Url.Action(ViewContext.RouteData.Values["action"].ToString(), new { 
                                page = Model.TotalPages, 
                                pageSize = Model.PageSize, 
                                search = Model.Search,
                                sortBy = Model.SortBy,
                                sortOrder = Model.SortOrder
                            })">@Model.TotalPages</a>
                        </li>
                    }
                }

                <!-- Next -->
                <li class="page-item @(Model.HasNext ? "" : "disabled")">
                    <a class="page-link" 
                       href="@(Model.HasNext ? Url.Action(ViewContext.RouteData.Values["action"].ToString(), new { 
                           page = Model.CurrentPage + 1, 
                           pageSize = Model.PageSize, 
                           search = Model.Search,
                           sortBy = Model.SortBy,
                           sortOrder = Model.SortOrder
                       }) : "#")"
                       aria-label="Next">
                        <i class="fas fa-chevron-right"></i>
                    </a>
                </li>
            </ul>
        </nav>

        <div class="page-size-selector">
            <label>แสดง:</label>
            <select class="form-control form-control-sm" onchange="changePageSize(this.value)">
                <option value="10" @(Model.PageSize == 10 ? "selected" : "")>10</option>
                <option value="25" @(Model.PageSize == 25 ? "selected" : "")>25</option>
                <option value="50" @(Model.PageSize == 50 ? "selected" : "")>50</option>
                <option value="100" @(Model.PageSize == 100 ? "selected" : "")>100</option>
            </select>
        </div>
    </div>

    <script>
        function changePageSize(pageSize) {
            var currentUrl = new URL(window.location.href);
            currentUrl.searchParams.set('pageSize', pageSize);
            currentUrl.searchParams.set('page', '1');
            window.location.href = currentUrl.toString();
        }
    </script>
}
