@inject LBDUSite.Services.ILocalizationService Localization

@{
    var currentLang = Localization.GetCurrentLanguage();
    var currentUrl = Context.Request.Path + Context.Request.QueryString;
}

<div class="language-switcher">
    <button class="language-btn @(currentLang == "th" ? "active" : "")" 
            onclick="changeLanguage('th')">
        <img src="/images/flags/th.svg" alt="ไทย" />
        <span>ไทย</span>
    </button>
    <button class="language-btn @(currentLang == "en" ? "active" : "")" 
            onclick="changeLanguage('en')">
        <img src="/images/flags/us.svg" alt="English" />
        <span>EN</span>
    </button>
</div>

<script>
    function changeLanguage(lang) {
        // ใช้วิธี GET แทน POST เพื่อหลีกเลี่ยงปัญหา CSRF Token
        var currentPath = window.location.pathname + window.location.search;
        window.location.href = '/Language/Change?lang=' + lang + '&returnUrl=' + encodeURIComponent(currentPath);
    }
</script>
