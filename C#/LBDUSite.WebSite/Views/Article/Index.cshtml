@model LBDUSite.ViewModels.ArticleListViewModel
@{
    ViewBag.Title = ViewBag.Title ?? "บทความและข่าวสาร";
}

<!-- Breadcrumb -->
<nav class="breadcrumb">
    <div class="breadcrumb-container">
        <ul class="breadcrumb-list">
            <li><a href="@Url.Action("Index", "Home")"><i class="fas fa-home"></i> หน้าแรก</a></li>
            <li class="breadcrumb-separator"><i class="fas fa-chevron-right"></i></li>
            <li class="active">บทความและข่าวสาร</li>
        </ul>
    </div>
</nav>

<!-- Article Header -->
<section class="page-header">
    <div class="page-header-container">
        <div class="page-header-content">
            <h1>
                <i class="fas fa-newspaper"></i>
                บทความและข่าวสาร
            </h1>
            <p>ความรู้และข่าวสารเกี่ยวกับการลงทุนในกองทุนรวม</p>
        </div>

        <!-- Search Box -->
        <div class="page-header-search">
            @using (Html.BeginForm("Index", "Article", FormMethod.Get, new { @class = "search-form" }))
            {
                <div class="search-input-group">
                    <i class="fas fa-search"></i>
                    <input type="text" 
                           name="search" 
                           value="@Model.SearchTerm" 
                           placeholder="ค้นหาบทความ..." />
                    @if (!string.IsNullOrEmpty(Model.Category))
                    {
                        <input type="hidden" name="category" value="@Model.Category" />
                    }
                    <button type="submit" class="btn btn-primary">ค้นหา</button>
                </div>
            }
        </div>
    </div>
</section>

<!-- Filter Section -->
<section class="filter-section">
    <div class="filter-container">
        <div class="filter-label">
            <i class="fas fa-filter"></i>
            หมวดหมู่:
        </div>
        <div class="filter-buttons">
            <a href="@Url.Action("Index", "Article", new { search = Model.SearchTerm })" 
               class="filter-btn @(string.IsNullOrEmpty(Model.Category) ? "active" : "")">
                ทั้งหมด
            </a>
            <a href="@Url.Action("Index", "Article", new { category = "ความรู้การลงทุน", search = Model.SearchTerm })" 
               class="filter-btn @(Model.Category == "ความรู้การลงทุน" ? "active" : "")">
                ความรู้การลงทุน
            </a>
            <a href="@Url.Action("Index", "Article", new { category = "ข่าวตลาดการเงิน", search = Model.SearchTerm })" 
               class="filter-btn @(Model.Category == "ข่าวตลาดการเงิน" ? "active" : "")">
                ข่าวตลาดการเงิน
            </a>
            <a href="@Url.Action("Index", "Article", new { category = "การวิเคราะห์กองทุน", search = Model.SearchTerm })" 
               class="filter-btn @(Model.Category == "การวิเคราะห์กองทุน" ? "active" : "")">
                การวิเคราะห์กองทุน
            </a>
            <a href="@Url.Action("Index", "Article", new { category = "คำถามที่พบบ่อย", search = Model.SearchTerm })" 
               class="filter-btn @(Model.Category == "คำถามที่พบบ่อย" ? "active" : "")">
                คำถามที่พบบ่อย
            </a>
        </div>
    </div>
</section>

<!-- Articles Grid -->
<section class="articles-section">
    <div class="articles-container">
        @if (Model.Articles.Any())
        {
            <div class="articles-grid">
                @foreach (var article in Model.Articles)
                {
                    @Html.Partial("_ArticleCard", article)
                }
            </div>

            <!-- Pagination -->
            @if (Model.TotalPages > 1)
            {
                <div class="pagination">
                    <!-- Previous Button -->
                    @if (Model.HasPreviousPage)
                    {
                        <a href="@Url.Action("Index", "Article", new { 
                            category = Model.Category, 
                            search = Model.SearchTerm, 
                            page = Model.CurrentPage - 1 
                        })" class="pagination-btn">
                            <i class="fas fa-chevron-left"></i> ก่อนหน้า
                        </a>
                    }
                    else
                    {
                        <span class="pagination-btn disabled">
                            <i class="fas fa-chevron-left"></i> ก่อนหน้า
                        </span>
                    }

                    <!-- Page Numbers -->
                    @{
                        var startPage = Math.Max(1, Model.CurrentPage - 2);
                        var endPage = Math.Min(Model.TotalPages, Model.CurrentPage + 2);

                        // Show first page
                        if (startPage > 1)
                        {
                            <a href="@Url.Action("Index", "Article", new { 
                                category = Model.Category, 
                                search = Model.SearchTerm, 
                                page = 1 
                            })" class="pagination-btn">1</a>

                            if (startPage > 2)
                            {
                                <span class="pagination-info">...</span>
                            }
                        }

                        // Show page range
                        for (int i = startPage; i <= endPage; i++)
                        {
                            if (i == Model.CurrentPage)
                            {
                                <span class="pagination-btn active">@i</span>
                            }
                            else
                            {
                                <a href="@Url.Action("Index", "Article", new { 
                                    category = Model.Category, 
                                    search = Model.SearchTerm, 
                                    page = i 
                                })" class="pagination-btn">@i</a>
                            }
                        }

                        // Show last page
                        if (endPage < Model.TotalPages)
                        {
                            if (endPage < Model.TotalPages - 1)
                            {
                                <span class="pagination-info">...</span>
                            }

                            <a href="@Url.Action("Index", "Article", new { 
                                category = Model.Category, 
                                search = Model.SearchTerm, 
                                page = Model.TotalPages 
                            })" class="pagination-btn">@Model.TotalPages</a>
                        }
                    }

                    <!-- Next Button -->
                    @if (Model.HasNextPage)
                    {
                        <a href="@Url.Action("Index", "Article", new { 
                            category = Model.Category, 
                            search = Model.SearchTerm, 
                            page = Model.CurrentPage + 1 
                        })" class="pagination-btn">
                            ถัดไป <i class="fas fa-chevron-right"></i>
                        </a>
                    }
                    else
                    {
                        <span class="pagination-btn disabled">
                            ถัดไป <i class="fas fa-chevron-right"></i>
                        </span>
                    }
                </div>
            }
        }
        else
        {
            <div class="no-results">
                <i class="fas fa-inbox"></i>
                <h3>ไม่พบบทความ</h3>
                <p>ลองค้นหาด้วยคำอื่นหรือเลือกหมวดหมู่อื่น</p>
            </div>
        }
    </div>
</section>

@section Styles {
    <style>
        /* Article Card Styles */
        .articles-section {
            padding: 60px 0;
            background: var(--gray-50);
        }

        .articles-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .articles-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .no-results {
            text-align: center;
            padding: 80px 20px;
        }

        .no-results i {
            font-size: 4rem;
            color: var(--gray-400);
            margin-bottom: 20px;
        }

        .no-results h3 {
            font-size: 1.5rem;
            color: var(--gray-900);
            margin-bottom: 10px;
        }

        .no-results p {
            font-size: 1rem;
            color: var(--gray-600);
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 60px 0;
        }

        .page-header-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .page-header-content h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }

        .page-header-content p {
            font-size: 1.125rem;
            opacity: 0.9;
        }

        .page-header-search {
            margin-top: 30px;
        }

        .search-form {
            max-width: 600px;
        }

        .search-input-group {
            display: flex;
            gap: 10px;
            background: white;
            border-radius: 50px;
            padding: 5px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .search-input-group i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray-400);
        }

        .search-input-group input {
            flex: 1;
            padding: 12px 20px 12px 45px;
            border: none;
            border-radius: 50px;
            font-size: 1rem;
        }

        .search-input-group button {
            border-radius: 50px;
            padding: 12px 30px;
        }

        /* Filter Section */
        .filter-section {
            background: white;
            border-bottom: 1px solid var(--gray-200);
            padding: 20px 0;
            position: sticky;
            top: 70px;
            z-index: 100;
        }

        .filter-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .filter-label {
            font-weight: 600;
            color: var(--gray-700);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 20px;
            border-radius: 20px;
            border: 1px solid var(--gray-300);
            background: white;
            color: var(--gray-700);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
            background: var(--primary-light);
        }

        .filter-btn.active {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
        }
    </style>
}
